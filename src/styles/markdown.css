@import "medium-zoom/dist/style.css";
@import "rehype-callouts/theme/vitepress";
@import url("https://gcore.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css");

:root {
  --color-text-primary: #0a0a0a;
  --color-text-secondary: #52525b;
  --color-text-muted: #6b7280;
  --color-text-paragraph: #52525b;
  --color-heading: #0a0a0a;
  --color-link: #0a0a0a;
  --color-link-hover: #1f2937;
  --color-anchor: #0a47c9;
  --color-blockquote: #0a0a0a;
  --color-mermaid-bg: #b9b9b9;

  /* èƒŒæ™¯é¢œè‰² */
  --color-bg-inline-code: #f1f3f5;
  --color-text-inline-code: #3b4252;
  --color-bg-polaroid: #ffffff;

  /* è¾¹æ¡†é¢œè‰² */
  --color-border-light: #e9edf2;
  --color-border-medium: #555, #555;
  --color-border-blockquote: #e6ebf2;

  /* é˜´å½± */
  --shadow-polaroid: 0 5px 15px rgb(0 0 0 / 0.15);
  --shadow-polaroid-hover: 0 8px 20px rgb(0 0 0 / 0.2);
  --shadow-polaroid-dark: 0 5px 15px rgb(0 0 0 / 0.3);

  /* å­—ä½“ */
  --font-family-handwritten: "Noto Sans SC", sans-serif, arial;
  --font-family-text: "Noto Serif SC", sans-serif;
  --font-geist-mono: "Fira Code", consolas, monospace;

  /* é—´è·ç³»ç»Ÿ */
  --space-xs: 0.25rem;
  --space-sm: 0.5rem;
  --space-md: 1rem;
  --space-lg: 1.5rem;
  --space-xl: 2rem;
  --space-2xl: 2.5rem;
  --space-3xl: 3rem;

  /* åœ†è§’ */
  --radius-sm: 0.25rem;
  --radius-md: 0.375rem;

  /* åŠ¨ç”» */
  --transition-fast: 0.3s ease;
  --transition-medium: 0.3s ease-in-out;
}

html.dark {
  --color-text-primary: #d5d5d6;
  --color-text-secondary: #a1a1aa;
  --color-text-muted: #9ca3af;
  --color-text-paragraph: #c5c5c5;
  --color-heading: #d5d5d6;
  --color-link: #e5e7eb;
  --color-link-hover: #f3f4f6;
  --color-anchor: #4982ec;
  --color-blockquote: #d5d5d6;
  --color-mermaid-bg: #7c7b7b;

  --color-bg-inline-code: #1e1e20;
  --color-text-inline-code: #c9d1d9;
  --color-bg-polaroid: #ffffff;

  --color-border-light: #181818;
  --color-border-medium: #555;
  --color-border-blockquote: #3a3a40;

  --shadow-polaroid: 0 5px 15px rgb(0 0 0 / 0.15);
  --shadow-polaroid-hover: 0 8px 20px rgb(0 0 0 / 0.2);
  --shadow-polaroid-dark: 0 5px 15px rgb(0 0 0 / 0.3);

  --font-family-handwritten: "Noto Sans SC", sans-serif, arial;
  --font-family-text: "Noto Serif SC", sans-serif;
  --font-geist-mono: "Fira Code", consolas, monospace;
}

/* ===== åŸºç¡€æ ·å¼é‡ç½® ===== */
.markdown {
  color: var(--color-text-paragraph);
  font-size: 1rem;
  line-height: 1.75;

  /* ç°ä»£æ–‡æœ¬æ¢è¡Œ */
  & :is(p, li, blockquote) {
    text-wrap: wrap;
  }

  /* ç§»é™¤é»˜è®¤è¾¹è· */
  & > :first-child {
    margin-block-start: 0;
  }
  & > :last-child {
    margin-block-end: 0;
  }
}

/* ===== æ ‡é¢˜æ ·å¼ (ä½¿ç”¨é€»è¾‘å±æ€§) ===== */
.markdown {
  & :is(h1, h2, h3, h4, h5, h6) {
    color: var(--color-heading);
    font-family: var(--font-family-handwritten);
    font-weight: 600;
    scroll-margin-top: 6rem;

    /* ç»Ÿä¸€çš„æ ‡é¢˜é”šç‚¹æ ·å¼ */
    &:is(:hover, :focus) .header-anchor {
      opacity: 0.6;
    }
  }

  & h1 {
    font-size: clamp(1.75em, 4vw, 2em);
    margin-block: 0 1em;
    line-height: 1.1111111;
  }

  & h2 {
    font-size: clamp(1.375em, 3vw, 1.5em);
    margin-block: 1.5em 0.75em;
    line-height: 1.3333333;
  }

  & h3 {
    font-size: clamp(1.175em, 2.5vw, 1.25em);
    margin-block: 1.25em 0.5em;
    line-height: 1.6;
  }

  & :is(h4, h5, h6) {
    font-size: clamp(1em, 2vw, 1.125em);
    margin-block: 1em 0.375em;
    line-height: 1.4;
  }

  /* è¿ç»­æ ‡é¢˜é—´è·ä¼˜åŒ– */
  & :is(h1, h2, h3, h4, h5, h6) + :is(h1, h2, h3, h4, h5, h6) {
    margin-block-start: 0.75em;
  }

  /* å±‚çº§é€’è¿›æ ‡é¢˜ï¼ˆæ›´ç´§å¯†ï¼‰ */
  & h1 + h2,
  & h2 + h3,
  & h3 + h4,
  & h4 + h5,
  & h5 + h6 {
    margin-block-start: 0.5em;
  }

  /* åŒçº§æ ‡é¢˜ï¼ˆç¨å®½æ¾ï¼‰ */
  & h2 + h2,
  & h3 + h3,
  & h4 + h4 {
    margin-block-start: 1em;
  }
}

/* ===== æ–‡æœ¬å†…å®¹æ ·å¼ ===== */
.markdown {
  & p {
    margin-block: 1.25em;
    font-size: 1em;
  }

  & :is(strong, b) {
    font-weight: 600;
    color: var(--color-text-primary);
  }

  & :is(em, i) {
    color: inherit;
    font-size: 1.05em;
  }

  /* é“¾æ¥æ ·å¼ */
  & a {
    color: var(--color-anchor);
    text-decoration: none;
    border-block-end: 1px solid var(--color-border-light);
    transition: border-color var(--transition-medium);

    &:hover {
      border-block-end-color: var(--color-border-medium);
    }

    /* ä»£ç é“¾æ¥ */
    & code {
      color: inherit;
    }
  }
}

/* ===== åˆ—è¡¨æ ·å¼ (ç°ä»£åŒ–ä¼ªå…ƒç´ ) ===== */
.markdown {
  & :is(ol, ul) {
    margin-block: 1.25em;
    list-style: none;
  }

  & li {
    margin-block: 0.5em;
    position: relative;
    padding-inline-start: 1.75em;
  }

  /* æœ‰åºåˆ—è¡¨ */
  & ol > li::before {
    content: counter(list-item) ".";
    position: absolute;
    inset-inline-start: 0;
    font-weight: 400;
  }

  /* æ— åºåˆ—è¡¨ */
  & ul > li::before {
    content: "";
    position: absolute;
    inset-inline-start: 0.2em;
    inset-block-start: calc(0.875em - 0.2em);
    inline-size: 0.4em;
    block-size: 0.4em;
    background-color: var(--color-text-secondary);
    border-radius: 50%;
    opacity: 0.8;
  }

  /* åµŒå¥—åˆ—è¡¨ */
  & :is(ul, ol) :is(ul, ol) {
    margin-block: 0.75em;
  }
}

/* ===== ä»»åŠ¡åˆ—è¡¨ ===== */
.markdown {
  & ul.contains-task-list {
    padding-inline-start: 0;

    & > li::before {
      display: none;
    }
  }

  & li.task-list-item {
    display: flex;
    align-items: flex-start;
    gap: var(--space-sm);
    padding-inline-start: 0;

    & input[type="checkbox"] {
      margin-block-start: 0.3em;
      inline-size: 1em;
      block-size: 1em;
      border: 1px solid var(--color-text-secondary);
      border-radius: var(--radius-sm);
      cursor: pointer;

      &:checked {
        background-color: var(--color-anchor);
        border-color: var(--color-anchor);
      }
    }
  }
}

/* ===== å¼•ç”¨å—æ ·å¼ ===== */
.markdown {
  & blockquote {
    font-weight: 500;
    font-style: italic;
    color: var(--color-blockquote);
    border-inline-start: 0.25rem solid var(--color-border-blockquote);
    margin-block: 1.6em;
    padding-inline-start: 1em;
    quotes: "\201C" "\201D" "\2018" "\2019";

    & > * {
      opacity: 0.7;

      &:first-child {
        margin-block-start: 0;
      }
      &:last-child {
        margin-block-end: 0;
      }
    }

    & p:first-of-type::before {
      content: open-quote;
    }
    & p:last-of-type::after {
      content: close-quote;
    }
  }
}

/* ===== ä»£ç æ ·å¼ ===== */
.markdown {
  /* è¡Œå†…ä»£ç  */
  & :where(code):not(:where(pre *, a *)) {
    background-color: var(--color-bg-inline-code);
    color: var(--color-text-inline-code);
    padding-block: 0.1rem;
    padding-inline: 0.3rem;
    font-family: var(--font-geist-mono);
    font-size: 0.875em;
    word-wrap: break-word;
    font-weight: 500;
  }

  /* ä»£ç å— */
  & pre {
    font-size: 0.9375em;
    line-height: 1.7142857;
    border-radius: 0rem 0rem var(--radius-md) var(--radius-md);
    padding: 0.8571429em 1.1428571em;

    & code {
      font-family: var(--font-geist-mono);
      padding: 0;
      font-weight: 400;
      color: inherit;
      font-size: inherit;
      line-height: inherit;
    }
  }

  figure[data-rehype-pretty-code-figure] {
    display: grid;
    grid-template-columns: minmax(0, 1fr);

    max-width: 100%;
    min-width: 0;

    margin-block: 1.5rem;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border-medium);
    overflow: hidden;
    overflow-x: hidden;
    background-color: #272822;

    /*è¿™é‡Œçš„ position æ˜¯ä¸ºäº†è®©è¯­è¨€è§’æ ‡å®šä½ */
    position: relative;
  }

  /* æ–‡ä»¶åæ ‡é¢˜æ  (è‡ªåŠ¨ç”Ÿæˆçš„ figcaption) */
  figure[data-rehype-pretty-code-figure] figcaption {
    min-width: 0%;
    width: 100%;
    box-sizing: border-box;

    background-color: #ffffff14;
    color: #e6e6e6;
    padding: 0.5rem 1rem;
    padding-right: 9rem;
    font-size: 0.85rem;
    font-family: var(--font-geist-mono);
    border-bottom: 1px solid var(--color-border-medium);
    font-family: "Cascadia Code", "Courier", monospace;

    /* é˜²æ­¢æ–‡ä»¶åå¤ªé•¿æ¢è¡Œ */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  figure[data-rehype-pretty-code-figure] figcaption::before {
    content: "ğŸ“„ ";
  }

  /* ä»£ç åŒºåŸŸ */
  figure[data-rehype-pretty-code-figure] pre {
    min-width: 0;
    margin: 0;
    padding: 1rem 1.25rem;
    border: none;
    border-radius: 0;
    background: transparent;
  }

  /* å—¯è¿™æ˜¯ä¸€ä¸ªä½ç½® */
  figcaption[data-rehype-pretty-code-title] {
    position: relative;
  }

  /* è¯­è¨€æ˜¾ç¤º (åˆ©ç”¨ figure ä¸Šçš„ data-language å±æ€§) */
  figcaption[data-rehype-pretty-code-title][data-language]::after {
    content: attr(data-language);
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    right: 0;
    padding-inline: 1rem;
    font-size: 0.75rem;
    font-weight: bold;
    text-transform: uppercase;
    color: rgba(255, 255, 255, 0.5);
    pointer-events: none;
  }
}

/* ===== å›¾ç‰‡å’Œåª’ä½“æ ·å¼ ===== */
.markdown {
  & img {
    margin-block: var(--space-xl);
    margin-inline: auto;
    will-change: transform, filter;
    transition: filter var(--transition-fast);

    /* Medium Zoom å›¾ç‰‡è¿‡æ¸¡ */
    &.medium-zoom-image {
      transition:
        filter var(--transition-fast),
        transform var(--transition-fast) !important;
    }

    /* æš—è‰²ä¸»é¢˜æ»¤é•œï¼ˆåŸºç¡€ä¸ºæ˜äº®æ¨¡å¼ï¼Œæš—è‰²åœ¨ä¸‹æ–¹ .dark è¦†ç›–ï¼‰ */
    &:not(.noDarken) {
      filter: none;
    }

    /* hoveræ—¶ä¸´æ—¶ç§»é™¤æ»¤é•œ */
    &:hover:not(.medium-zoom-image--opened):not(.noDarken) {
      filter: none !important;
    }
  }

  & video {
    margin-block: var(--space-xl);
  }
}

.dark .markdown img:not(.noDarken) {
  filter: brightness(0.75) contrast(1.1);
}

/* ===== è¡¨æ ¼æ ·å¼ ===== */
.markdown {
  & table {
    max-width: 100%;
    margin: 0 auto;
    table-layout: auto;
    text-align: left;
    font-size: 0.9375em;
    line-height: 1.7142857;
    border-collapse: collapse;
  }

  & thead {
    color: var(--color-text-primary);
    font-weight: 600;
    border-block-end: 1px solid var(--color-border-light);

    & th {
      vertical-align: bottom;
      padding: 0.5714286em;
      white-space: nowrap;

      &:first-child {
        padding-inline-start: 0;
      }
      &:last-child {
        padding-inline-end: 0;
      }
    }
  }

  & tbody {
    & tr {
      border-block-end: 1px solid var(--color-border-light);

      &:last-child {
        border-block-end: none;
      }
    }

    & td {
      vertical-align: top;
      padding: 0.5714286em;

      &:first-child {
        padding-inline-start: 0;
        white-space: nowrap;
      }

      &:last-child {
        padding-inline-end: 0;
      }
    }
  }
}

/* ===== é”šç‚¹é“¾æ¥æ ·å¼ ===== */
.markdown a.header-anchor {
  float: inline-start;
  margin-inline-start: -1.5em;
  border: none !important;
  opacity: 0;
  font-size: 0.7em;
  text-decoration: none;
  color: var(--color-anchor);
  transition: opacity var(--transition-fast);

  &:is(:hover, :focus) {
    text-decoration: none;
    color: var(--color-anchor);
    opacity: 1;
  }
}

/* ===== è„šæ³¨æ ·å¼ ===== */
.markdown .footnotes {
  margin-block-start: var(--space-3xl);
  font-size: 0.875em;
  color: var(--color-text-secondary);
  opacity: 0.9;

  &::before {
    content: "";
    display: block;
    inline-size: 100%;
    margin-block-end: 1.5em;
    border-block-start: 1px solid var(--color-border-light);
  }

  & li {
    margin-block: 0.5em;

    & p {
      margin: 0;
    }
  }

  & .data-footnote-backref {
    text-decoration: none;
    opacity: 0.7;
    cursor: pointer;
    border: none;

    &:hover {
      opacity: 1;
    }
  }
}

/* ===== è¯¦æƒ…/æ‘˜è¦æ ·å¼ ===== */
.markdown {
  & details {
    margin-block: 1.25em;

    & summary {
      padding-inline-start: 1px;
      cursor: pointer;
    }
  }

  & li details {
    margin-block: 0.5em;
  }
}

/* ===== ç‰¹æ®Šç»„ä»¶æ ·å¼ ===== */
/* Medium Zoom */
.medium-zoom-overlay,
.medium-zoom-image--opened {
  z-index: 300;
}

/* ===== å“åº”å¼è®¾è®¡ ===== */
@media (width <= 768px) {
  image-figure-polaroid {
    margin-inline: 10%;
  }

  .markdown {
    font-size: 0.9375rem;

    & a.header-anchor {
      font-size: 0.75em;
    }

    & table {
      display: block;
      max-width: 100%;
      width: 100%;

      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      font-size: 0.875em;

      & :is(th, td) {
        min-inline-size: 4em;
        padding: 0.5em;
      }

      & td {
        word-break: break-word;
      }
    }

    & pre {
      margin-block: 1.5em;
      padding: 1em;
      font-size: 0.875em;
    }

    & :is(img, video) {
      margin-block: 1.5em;
    }
  }
}

/* ===== å®¹å™¨æŸ¥è¯¢ (ç°ä»£CSS) ===== */
@container (width <= 600px) {
  .markdown {
    & h1 {
      font-size: 1.75em;
    }
    & h2 {
      font-size: 1.375em;
    }
    & h3 {
      font-size: 1.175em;
    }
  }
}

/* ===== ä¸»é¢˜åˆ‡æ¢æ”¯æŒ ===== */
.img-light {
  display: block;
}

.img-dark {
  display: none;
}

.dark .img-light {
  display: none;
}

.dark .img-dark {
  display: block;
}

/* ===== KaTeX æ•°å­¦å…¬å¼é€‚é… ===== */
.markdown .katex-display {
  overflow-x: auto;
  overflow-y: hidden;
  max-inline-size: 100%;
  padding-block: 0.5em;

  & > .katex {
    max-inline-size: 100%;

    & > .katex-html {
      max-inline-size: 100%;
      overflow-x: auto;
      overflow-y: hidden;
      padding-inline: 0.25em;
    }
  }
}

/* ===== å¤–éƒ¨é“¾æ¥æ ·å¼ ===== */
.new-tab-icon {
  margin-inline-start: 0.1rem;
  margin-block-end: 0.3rem;
  font-size: 0.6em;
}

.external-link-cursor {
  cursor: var(--external-link-cursor);
}

/* ===== å¾½ç« æ ·å¼ ===== */
.rds-badge {
  display: inline-block;
  padding: 0.125rem 0.375rem;
  border-radius: var(--radius-sm);
  margin-inline-end: 0.5rem;
  color: white;
  font-size: 0.75rem;
  line-height: 1rem;
  text-transform: uppercase;
  background-color: #a8a29e;

  &[data-badge="n"] {
    background-color: #f87171;
  }
}

.dark .rds-badge {
  color: black;
}

.dark .rds-badge[data-badge="n"] {
  background-color: #fecaca;
}

/* ===== é“¾æ¥å›¾æ ‡æ ·å¼ ===== */
:is(
    [data-link="github-acct"],
    [data-link="github-repo"],
    [data-link="custom-url"],
    [data-link="npm-pkg"]
  )
  > img {
  display: inline-block;
  inline-size: 1em;
  block-size: 1em;
  border-radius: 0;
  margin: 0;
  margin-inline-end: 0.3em;
  margin-block-end: 0.1em;
}

/* ===== è§†é¢‘æ ·å¼ ===== */
.rds-video {
  z-index: 150;
  position: relative;
  inline-size: 100%;
  aspect-ratio: 16 / 9;
  margin-block: var(--space-xl);
  transform: scale(1, 1) !important;
}

/* ===== å‡å°‘åŠ¨ç”»åå¥½è®¾ç½® ===== */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  image-figure-polaroid {
    transition: none;
  }
}

/* æ–‡ç« æ­£æ–‡é‡Œçš„é“¾æ¥è‡ªåŠ¨æ¢è¡Œ */
.markdown a {
  overflow-wrap: anywhere;
  word-break: break-word;
  white-space: normal;
}

/* å¦‚æœé“¾æ¥å‡ºç°åœ¨ä»£ç å—æˆ–å†…è”ä»£ç é‡Œ */
.markdown pre,
.markdown code {
  white-space: pre-wrap;
  word-break: break-word;
}

footer {
  color: var(--color-text-secondary);
  font-style: italic;
}

header {
  color: var(--color-heading);
}

nav {
  color: var(--color-text-primary);
}
